<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
    <head>
        <title>How to use SFTP (with server validation - public key files)</title>
        <meta name="keywords" content="Chapter 3,">
        <link rel="stylesheet" type="text/css" href="../css/edtmanual.css">
        <link rel="stylesheet" type="text/css" href="../css/prism.css"/>
    </head>
    <body>
        <h1>How to use SFTP (with server validation - public key files)</h1>
        <p>As discussed in <a href="howtousesftpwithservervalidationknownhosts.html">How to use SFTP (with server validation - known hosts)</a>, SFTP clients can validate servers by loading a list of approved servers and their public keys, 
            and checking the server key against this list. The list is generally maintained in a file called <i>known_hosts</i>.
        </p>
        <p>In <a href="../../api/com/enterprisedt/net/ftp/ssh/SSHFTPClient.html">SSHFTPClient</a>, server validation is always enabled by default - it must be explicitly disabled as described in 
            <a href="howtousesftpwithoutservervalidation.html">How to use SFTP (without server validation)</a>.
        </p>
        <p>Server public keys can also be maintained in their own individual key files and be used for server validation without adding them to the <i>known_hosts</i> file. The 
            <a href="../../api/com/enterprisedt/net/ftp/ssh/SSHFTPValidator.html">SSHFTPValidator</a> supports explicitly adding server public keys.
        </p>
        <p>The <a href="../../api/com/enterprisedt/net/ftp/ssh/SSHFTPValidator.html#addKnownHost%28java.lang.String,%20java.lang.String%29">addKnownHost</a> method requires the hostname and the public key file, 
            as shown below:
        </p>
        <pre><code class="language-java">ftp.<a href="../../api/com/enterprisedt/net/ftp/ssh/SSHFTPClient.html#getValidator%28%29">getValidator</a>().<a href="../../api/com/enterprisedt/net/ftp/ssh/SSHFTPValidator.html#addKnownHost%28java.lang.String,%20java.lang.String%29">addKnownHost</a>("hostname","myhost.dsa.pub");</code></pre>
        <p>Note that the server may send back an RSA key or a DSA key. If the key file contains a DSA key for the host, and an RSA key is returned, <b>server validation will fail</b>. 
            The server can be forced to send back a particular type of key as described in <a href="howtousesftpchoosingalgorithms.html">How to use SFTP (choosing algorithms)</a>.
        </p>
        <p>SSH public key files have two standard formats - OpenSSH and SECSH.  edtFTPj/PRO supports both these public key formats. Formats can be recognized by their first line as shown in the table below:</p>
        </span></font><br>
        <table border="1"  bordercolor="#999999"  width="567"  cellpadding="5"  cellspacing="0"  style="border-collapse: collapse; font-size:14px; margin-left:10px;">
            <tbody>
                <tr>
                    <td><b>Public key type</b></td>
                    <td><b>Start of first line</b></td>
                </tr>
                <tr>
                    <td><tt>OpenSSH  (DSA)</tt></td>
                    <td><tt>ssh-dss AAAAB3NzaC1kc3MAA ...</tt></td>
                </tr>
                <tr>
                    <td><tt>OpenSSH  (RSA)</tt></td>
                    <td><tt>ssh-rsa AAAAB3NzaC1yc2EAA ...</tt></td>
                </tr>
                <tr>
                    <td><tt>SECSH</tt></td>
                    <td><tt>---- BEGIN SSH2 PUBLIC KEY ----</tt></td>
                </tr>
            </tbody>
        </table>
        <p>You can convert between OpenSSH and SECSH using OpenSSH's <i>ssh-keygen</i> (which by default generates OpenSSH keys). </p>
        <p>For example, to convert an OpenSSH public key generated by ssh-keygen to SECSH for use in a commercial SSH server, use:</p>
        <pre><code class="language-java">ssh-keygen -f keyfile -e > keyfile.secsh</code></pre>
        <script src="../js/prism.js"></script>
    </body>
</html>

